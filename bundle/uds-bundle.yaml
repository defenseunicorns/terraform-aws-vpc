# yaml-language-server: $schema=https://raw.githubusercontent.com/defenseunicorns/uds-cli/main/uds.schema.json
kind: UDSBundle
metadata:
  name: opentofu-vpc-deploy
  description: A UDS bundle for deploying a VPC module using OpenTofu
  version: 1.0.0

packages:
  - name: terraform-vpc
    path: "../"  # Ensure this points to the correct local path to the root directory containing the zarf.yaml
    ref: "1.0.0"  # Version reference for the Terraform package
    overrides:
      terraform-deploy-vpc:
        terraform-vars-chart:
          values:
            - path: name
              value: ""  # Set this if needed dynamically at deploy time
            - path: tags
              value: {}
            - path: vpc_cidr
              value: ""  # Example: "10.200.0.0/16"
            - path: azs
              value: ["us-gov-west-1a", "us-gov-west-1b", "us-gov-west-1c"]  # Example: ["us-west-1a", "us-west-1b", "us-west-1c"]
            - path: private_subnet_tags
              value: {}
            - path: create_database_subnet_group
              value: true
            - path: instance_tenancy
              value: "dedicated"  # Example: "default" or "dedicated"
            - path: public_subnets
              value: []  # Example: ["subnet-12345", "subnet-67890"]
            - path: private_subnets
              value: []  # Example: ["subnet-23456", "subnet-78901"]
            - path: database_subnets
              value: []
            - path: intra_subnets
              value:
                - "100.64.0.0/18"
                - "100.64.64.0/18"
                - "100.64.128.0/18"
            - path: intra_subnet_tags
              value: {}
            - path: enable_nat_gateway
              value: "false"
            - path: single_nat_gateway
              value: "false"
            - path: secondary_cidr_blocks
              value:
                - "100.64.0.0/16"
            - path: vpc_flow_log_permissions_boundary
              value: null
            - path: flow_log_cloudwatch_log_group_retention_in_days
              value: 365
            - path: flow_log_log_format
              value: null
            - path: ip_offsets_per_subnet
              value: null
            - path: create_default_vpc_endpoints
              value: true
            - path: ecr_endpoint_policy
              value: null
            - path: enable_fips_vpce
              value: "false"
            - path: enable_ses_vpce
              value: "true"
          variables:
            - name: VPC_NAME
              path: name
            - name: ENABLE_FIPS
              path: enable_fips_vpce
            - name: ENABLE_SES_VPCE
              path: enable_ses_vpce
            - name: AZS
              path: azs
            - name: PUBLIC_SUBNETS
              path: public_subnets
            - name: PRIVATE_SUBNETS
              path: private_subnets
